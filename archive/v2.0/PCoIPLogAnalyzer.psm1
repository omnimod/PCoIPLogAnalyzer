#Get data from pcoip_server log file and returns PSObject with data
function global:Import-PCoIPLog {
	<#
		.SYNOPSIS
		This Cmdlet parses the PCoIP log file and returns an object with detailed information

		.PARAMETER FilePath
		Specifies the path to the pcoip_server log file.
		
		.EXAMPLE
		$PCoIPLog = Import-PCoIPLog -FilePath "C:\Logs\pcoip_server_2014_07_24_00000b8c.txt"
		Description
		
		-----------
		
		This command returns the PSObject which contains information about PCoIP session from the log file.
		
		.LINK
		https://github.com/omnimod/PCoIPLogAnalyzer
	#>
	
	[CmdletBinding(
		DefaultParameterSetName="FilePath"
	)]

	Param(
		[Parameter(Mandatory=$True,
		Position=0,
		HelpMessage="Please enter the path to the pcoip_server log file")]
		[String] $FilePath
	)

	#Return an array with network statistics (RX and TX packets for Audio, Image and Other traffic, and percentage of Loss)
	function Get-NetStats {
		$NetStats = @()
		
		#Pattern to match strings like: R=000000/000000/001999  T=000287/003728/000953 (A/I/O) Loss=0.00%/0.00% (R/T)
		$ValuePattern = 'R=([0-9]+)\/([0-9]+)\/([0-9]+)\s+T=([0-9]+)\/([0-9]+)\/([0-9]+)\s+\(A\/I\/O\)\s+Loss=([0-9.]+)\%\/([0-9.]+)\%\s+\(R\/T\)$'
		$Pattern = $DatePattern + $ValuePattern
		
		foreach($String in $Log) {
			if($String -match $Pattern) {
				$NetStats += [PsCustomObject]@{
					Date = [DateTime] $Matches[1]
					RXAudio = [Int] $Matches[2]
					RXImage = [Int] $Matches[3]
					RXOther = [Int] $Matches[4]
					TXAudio = [Int] $Matches[5]
					TXImage = [Int] $Matches[6]
					TXOther = [Int] $Matches[7]
					RXLoss = [System.Math]::Round([Float] $Matches[8], 2)
					TXLoss = [System.Math]::Round([Float] $Matches[9], 2)
				}
			}
		}
		return $NetStats
	}

	#Return an array with latency statistics
	function Get-BdwthStats {
		$BdwthStats = @()
		
		#Pattern to match strings like: Tx thread info: bw limit = 1165, avg tx = 52.3, avg rx = 4.7 (KBytes/s)
		$ValuePattern = 'bw limit =\s+(\d+).+avg tx =\s+([0-9.]+), avg rx =\s+([0-9.]+)\s+\(KBytes\/s\)$'
		$Pattern = $DatePattern + $ValuePattern
		foreach($String in $Log) {
			if($String -match $Pattern) {
				$BdwthStats += [PsCustomObject]@{
					Date = [DateTime] $Matches[1]
					BWLimit = [System.Math]::Round([Float] $Matches[2], 2) 
					AVGTX = [System.Math]::Round([Float] $Matches[3], 2)
					AVGRX = [System.Math]::Round([Float] $Matches[4], 2)				
				}
			}
		}	
		return $BdwthStats
	}

	#Return an array with latency statistics
	function Get-LatStats {
		$LatStats = @()
		
		#Pattern to match strings like: Tx thread info: round trip time (ms) =   5, variance =   2, rto = 107, last =   6, max =  52
		$ValuePattern = 'round trip time \(ms\) =\s+(\d+),\s+variance =\s+(\d+), rto =\s+(\d+),\slast =\s+(\d+), max =\s+(\d+)$'
		$Pattern = $DatePattern + $ValuePattern
		foreach($String in $Log) {
			if($String -match $Pattern) {
				$LatStats += [PsCustomObject]@{
					Date = [DateTime] $Matches[1]
					RTT = [Int] $Matches[2]
					Variance = [Int] $Matches[3]
					RTO = [Int] $Matches[4]
					Last = [Int] $Matches[5]
					Max = [Int] $Matches[6]
				}
			}
		}
		return $LatStats
	}

	#Return an array with quality statistics (TBL, FPS, Quality)
	function Get-QualityStats {
		$QualityStats = @()
		
		#Pattern to match strings like: tbl 2 fps 9.56 quality 70 
		$ValuePattern = 'tbl\s+(\d+)\s+fps\s([0-9.]+)\s+quality\s+(\d+)$'
		$Pattern = $DatePattern + $ValuePattern
		foreach($String in $Log) {
			if($String -match $Pattern) {
				$QualityStats += [PsCustomObject]@{
					Date = [DateTime] $Matches[1]
					TBL = [Int] $Matches[2]
					FPS = [System.Math]::Round([Float] $Matches[3], 2)
					Quality = [Int] $Matches[4]
				}
			}
		}	
		return $QualityStats
	}

	#Return an array with encoding statistics
	function Get-EncodStats {
		$EncodStats = @()
		
		#Pattern to match strings like: bits/pixel - 1.01, bits/sec - 391077.40, MPix/sec - 0.39
		$ValuePattern = 'bits\/pixel -\s+([0-9.]+),\s+bits\/sec -\s+([0-9.]+),\s+MPix\/sec -\s+([0-9.]+)$'
		$Pattern = $DatePattern + $ValuePattern
		foreach($String in $Log) {
			if($String -match $Pattern) {
				$EncodStats += [PsCustomObject]@{
					Date = [DateTime] $Matches[1]
					BitsPixel = [System.Math]::Round([Float] $Matches[2], 2)
					BitsSec = [System.Math]::Round([Float] $Matches[3], 2)
					MPixSec = [System.Math]::Round([Float] $Matches[4], 2)		
				}
			}
		}	
		return $EncodStats
	}

	#Return an array with advanced statistics
	function Get-AdvStats {
		$AdvStats = @()
		
		#Pattern to match strings like: cur_s   0 max_s  30 bwc 0.32 bwt 8.19 changed fps 19.5 decode rate est (MBit/sec) - 1.58
		$ValuePattern = 'cur_s\s+(\d)+\s+max_s\s+(\d+)\s+bwc\s+([0-9.]+)\s+bwt\s+([0-9.]+)\s+changed fps\s+([0-9.]+)\s+decode rate est \(MBit\/sec\) -\s+([0-9.]+)$'
		$Pattern = $DatePattern + $ValuePattern
		foreach($String in $Log) {
			if($String -match $Pattern) {
				$AdvStats += [PsCustomObject]@{
					Date = [DateTime] $Matches[1]
					Cur_s = [Int] $Matches[2]
					Max_s = [Int] $Matches[3]
					BWC = [System.Math]::Round([Float] $Matches[4], 2)
					BWT = [System.Math]::Round([Float] $Matches[5], 2)
					ChangedFPS = [System.Math]::Round([Float] $Matches[6], 2)
					DecodeRate = [System.Math]::Round([Float] $Matches[7], 2)		
				}
			}
		}	
		return $AdvStats
	}

	#Return an array with display statistics (number of displays and resolution)
	function Get-DisplayStats {
		$DisplayStats = @()
		
		#Pattern to match strings like: configure_display[0]--*  id: 1  mon_id: -1 pos: (0,0)  w: 1468   h: 826
		$ValuePattern = 'configure_display\[(\d)\].+w:\s+(\d+)\s+h:\s+(\d+)$'
		$Pattern = $DatePattern + $ValuePattern
		foreach($String in $Log) {
			if($String -match $Pattern) {
				$DisplayStats += [PsCustomObject]@{
					Date = [DateTime] $Matches[1]
					DisplayID = [Int] $Matches[2]
					Width = [Int] $Matches[3]
					Height = [Int] $Matches[4]
				}
			}
		}	
		return $DisplayStats
	}

	#Return an object with PCoIP protocol version
	#Horizon 5.3 - 3.12.3.26912
	#Horizon 6.0 - 3.18.0.33014
	#Horizon 6.1 - 3.30.0.6dc506
	#Horizon 6.2 - 3.32.0.c369d5
	#Horizon 7.3.1 - 3.40.0.31163
	function Get-ProtocolVersion {
	
		#Pattern to match strings like: Software Build ID: pcoip-soft.git-vmw-6299018 3.40.0.31163a
		$Pattern = 'MGMT_SYS :Software Build ID: (.+ (\d+).(\d+).(\d+).(.+))$'
		
		foreach($String in $Log) {
			if($String -match $Pattern) {
				$Full = [String] $Matches[1]
				$Major = [String] $Matches[2]
				$Minor = [String] $Matches[3]
				$Build = [String] $Matches[4]
				
				#Convert Revision from Hex to Decimal because [Version] type does not accept letters
				$Revision = [String] [convert]::toint32($Matches[5],16)
				$Short = [Version]($Major + "." + $Minor + "." + $Build + "." + $Revision)		
				
				$Version = [PsCustomObject]@{
					Full = $Full
					Short = $Short
					Major = $Major
					Minor = $Minor
					Build = $Build
					Revision = $Revision
				}
				return $Version
			}
		}
		return $null
	}

	#Retrieve single value from the array with pattern
	function Get-Value {
		param([String] $Pattern,
			[Array] $Log = $Log)
		
		foreach($String in $Log) {
			if($String -match $Pattern) {
				return $Matches[1]
			}
		}

		return $null
	}

	function Get-ServerName {
		$Pattern = 'pcoip.default_target_sni = (.+)$'
		
		return Get-Value $Pattern
	}

	function Get-ServerIP {
		$Pattern = 'pcoip.ip_address = ([0-9.]+)$'
		
		return Get-Value $Pattern
	}

	function Get-ClientIP {
		$Pattern = 'Incoming session with: ([0-9.]+)$'
		
		return Get-Value $Pattern
	}

	function Get-Encryption {
		$Pattern = 'Setting encryption to (.+).$'
		
		return Get-Value $Pattern
	}

	function Get-StartTime {
		return [DateTime] (Get-Value $DatePattern $Log[0])
	}

	function Get-EndTime {
		return [DateTime] (Get-Value $DatePattern $Log[$_.Count-1])
	}
	
	#Check if log file exists, if not - stop the script with error
	if (Test-Path $FilePath) {
		$LogFile = Get-Item $FilePath
		$Log = Get-Content $LogFile
	} else {
		Write-Error "File is not available"
		return $null
	}
	
	#PCoIP version previous to 3.32.0 (Horizon Agent 6.2) has an old date format
	#New date format: 2017-12-16T19:44:21.965+03:00
	#Old date format: 07/24/2014, 18:38:05.140
	$OldDatePattern = '^(\d\d\/\d\d\/\d{4}, \d\d:\d\d:\d\d.[0-9]+).+'
	$NewDatePattern = '^(\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d\.[0-9+:]+).+'

	$Version = Get-ProtocolVersion
	if($Version -eq $null) {
		Write-Error "Log file is damaged or has unsupported format"
		return $null
	}

	#Depends on version of the log file define the date pattern
	if($Version.Short -ge "3.32.0") {
		$DatePattern = $NewDatePattern
	} else {
		$DatePattern = $OldDatePattern
	}

	$StarTime = Get-StartTime
	$EndTime = Get-EndTime

	#Create PSObject with data from the log file
	$PCoIPLog = [PsCustomObject]@{
		LogFile = $LogFile.Name
		StartTime = $StarTime
		EndTime = $EndTime
		Duration = ($EndTime - $StarTime)
		Server = @{
			Name = (Get-ServerName)
			IP = (Get-ServerIP)
		}
		Client = @{
			IP = (Get-ClientIP)
		}
		Version = $Version
		Encryption = (Get-Encryption)
		NetStats = (Get-NetStats)
		BdwthStats = (Get-BdwthStats)
		LatStats = (Get-LatStats)
		QualityStats = (Get-QualityStats)
		EncodStats = (Get-EncodStats)
		AdvStats = (Get-AdvStats)
		DisplayStats = (Get-DisplayStats)
	}

	return $PCoIPLog	
}

#Export date from PSObject to TEXT, CSV or HTML format
function global:Export-PCoIPStatistics {
	<#
		.SYNOPSIS
		This Cmdlet exports information from the PCoIP log object to a file in text, csv or html format

		.PARAMETER PCoIPLog
		Specifies the PCoIPLog object which contains information about PCoIP session.
		
		.PARAMETER ResultPath
		Specifies the path to the file where results will be saved.
		
		.PARAMETER Format
		Specifies the format of the result file.
		
		.PARAMETER MaxSamples
		Specifies the maximum number of rows in the output.
		
		.EXAMPLE
		Export-PCoIPStatistics -PCoIPLog $PCoIPLog -ResultPath "C:\Results\report.txt"
		Description
		
		-----------
		
		This command exports information from the PCoIP log object to the text file.
	
		.EXAMPLE
		Export-PCoIPStatistics -PCoIPLog $PCoIPLog -ResultPath "C:\Results\report.html" -Format HTML
		Description
		
		-----------
		
		This command exports information from the PCoIP log object to the html file.		

		.EXAMPLE
		Export-PCoIPStatistics -PCoIPLog $PCoIPLog -ResultPath "C:\Results\report.csv" -Format CSV -MaxSamples 100
		Description
		
		-----------
		
		This command exports information from the PCoIP log object to the csv file limiting the number of rows to 100.
			
		.LINK
		https://github.com/omnimod/PCoIPLogAnalyzer
	#>

	Param(
		[Parameter(Mandatory=$True,
		Position=0,
		HelpMessage="Please enter the PCoIP log object which contains session information")]
		[PsCustomObject] $PCoIPLog,
		
		[Parameter(Mandatory=$True,
		Position=1,
		HelpMessage="Please enter the path where the result file will be saved")]
		[String] $ResultPath,
		
		[Parameter(
		HelpMessage="Please specify the format of the result file. Could be TEXT, HTML or CSV")]
		[ValidateSet("CSV", "HTML", "TEXT")]
		[String] $Format = "TEXT",
		
		[Parameter(
		HelpMessage="Please specify the maximum number of rows to output. If not defined, the default value is 1000")]
		[Int] $MaxSamples = 1000
	)

	#Reduce the size of array to limit number of exported/displayed values
	function Resize-Array {
		param([Array] $Arr, [Int] $MaxSamples)
		
		$size = $Arr.Count
		
		if ($size -lt $MaxSamples) {
			return $Arr
		}
		
		$ResizeArray = @()
		
		for ($i = 0; $i -lt $size; $i += [math]::Ceiling($size/$MaxSamples)) {
			$ResizedArray = [Array]$ResizedArray + $Arr[$i]
		}	
		
		return $ResizedArray	
	}
	
	#Convert an array to the string with commas delimeter for HTML report
	function Serialize-Array {
		param([Array] $Arr)
		
		$Serial = ""
		$First = $true
		
		foreach($Num in $Arr) {
		
			if($First) {
				$First = $false
			} else {
				$Serial += ", "
			}
			
			# Format based on the Num type
			$NumFormat=""
			
			if($Num.GetType().Name -eq "DateTime") {
				$NumFormat = "g"
			} elseif($Num.GetType().Name -eq "Double") {
				$NumFormat = "f2"
			} else {
				$NumFormat = "f0"
			}
			
			$Serial += "'" + $Num.ToString($NumFormat, $enUS) + "'"

		}
		
		return $Serial
	}
	
	#Replace ${parameter} with value
	function Update-Template {
		param(
			[String] $SearchString,
			[String] $Value)

		$Template = $Template.Replace($SearchString, $Value)
		return $Template
	}
	
	#Create a string array with csv formatted data from PSObject
	function New-PCoIPCSVReport {
		param(
			[PsCustomObject] $PCoIPLog,
			[Int] $MaxSamples)
		
		$Result = @()
		$Result += Resize-Array -Arr $PCoIPLog.NetStats -MaxSamples $MaxSamples | ConvertTo-Csv -Delimiter ";" -NoTypeInformation
		$Result += Resize-Array -Arr $PCoIPLog.BdwthStats -MaxSamples $MaxSamples | ConvertTo-Csv -Delimiter ";" -NoTypeInformation
		$Result += Resize-Array -Arr $PCoIPLog.LatStats -MaxSamples $MaxSamples | ConvertTo-Csv -Delimiter ";" -NoTypeInformation
		$Result += Resize-Array -Arr $PCoIPLog.QualityStats -MaxSamples $MaxSamples | ConvertTo-Csv -Delimiter ";" -NoTypeInformation
		$Result += Resize-Array -Arr $PCoIPLog.EncodStats -MaxSamples $MaxSamples | ConvertTo-Csv -Delimiter ";" -NoTypeInformation
		$Result += Resize-Array -Arr $PCoIPLog.AdvStats -MaxSamples $MaxSamples | ConvertTo-Csv -Delimiter ";" -NoTypeInformation
		$Result += Resize-Array -Arr $PCoIPLog.DisplayStats -MaxSamples $MaxSamples | ConvertTo-Csv -Delimiter ";" -NoTypeInformation		
		
		return $Result
	}
	
	#Create a HTML report from template filled with data from PSObject
	function New-PCoIPHTMLReport {
		param(
			[PsCustomObject] $PCoIPLog,
			[String] $Template,
			[Int] $MaxSamples)		
		
		#Define all parameters that should be replaced with values from PSObject in HTML template
		#In template all parameters are defined in '${parameter}' format and have the same names as PSObject parameters
		$Props = @(
				"LogFile",
				"StartTime",
				"EndTime",
				"Duration",
				"Encryption",
				"Server.Name",
				"Server.IP",
				"Client.IP",
				"Version.Full",
				"NetStats.Date",
				"NetStats.RXAudio",
				"NetStats.RXImage",
				"NetStats.RXOther",
				"NetStats.TXAudio",
				"NetStats.TXImage",
				"NetStats.TXOther",
				"NetStats.RXLoss",
				"NetStats.TXLoss",
				"BdwthStats.Date",
				"BdwthStats.BWLimit",
				"BdwthStats.AVGTX",
				"BdwthStats.AVGRX",
				"LatStats.Date",
				"LatStats.RTT",
				"LatStats.Max",
				"QualityStats.Date",
				"QualityStats.FPS",
				"QualityStats.Quality",
				"LAST.NetStats.RXAudio",
				"LAST.NetStats.RXImage",
				"LAST.NetStats.RXOther",
				"LAST.NetStats.TXAudio",
				"LAST.NetStats.TXImage",
				"LAST.NetStats.TXOther",
				"AVG.BdwthStats.AVGRX",
				"AVG.BdwthStats.AVGTX",
				"MAX.NetStats.RXLoss",
				"AVG.NetStats.RXLoss",
				"MAX.NetStats.TXLoss",
				"AVG.NetStats.TXLoss",	
				"MAX.LatStats.Max",
				"AVG.LatStats.RTT",
				"MAX.QualityStats.Quality",	
				"MIN.QualityStats.Quality",	
				"MAX.QualityStats.FPS",		
				"AVG.QualityStats.FPS",		
				"MIN.QualityStats.FPS")

		foreach($Prop in $Props) {
			#Determine the number of words separated with .dots in parameter
			$Vars = $Prop -split "\."

			Switch ($Vars.Count) {
				#Single word parameters are basically the strings which should be replaced as is
				1 {
					$Value = $PCoIPLog.($Vars[0]).ToString()		
				}

				#Two words parameters could be strings or arrays
				2 {
					if($PCoIPLog.($Vars[0]).($Vars[1]).GetType().BaseType -eq [Array]) {
						$Value = Serialize-Array (Resize-Array -Arr $PCoIPLog.($Vars[0]).($Vars[1]) -MaxSamples $MaxSamples)
					} else {
						$Value = $PCoIPLog.($Vars[0]).($Vars[1]).ToString()				
					}
				}
				3 {
				#Three words parameters are the phrases, the first word is math/logical operation, the second and the third is a parameter
					Switch($Vars[0]) {
						"AVG" {
							$Value = ($PCoIPLog.($Vars[1]).($Vars[2]) | Measure-Object -Average).Average
						}
						"MIN" {
							$Value = ($PCoIPLog.($Vars[1]).($Vars[2]) | Measure-Object -Minimum).Minimum					
						}
						"MAX" {
							$Value = ($PCoIPLog.($Vars[1]).($Vars[2]) | Measure-Object -Maximum).Maximum				
						}
						"FIRST" {
							$Value = ($PCoIPLog.($Vars[1]).($Vars[2])[0])
						}
						"LAST" {
							$Value = ($PCoIPLog.($Vars[1]).($Vars[2])[-1])
						}
						Default {
							$Value = 0
						}
					}
					
					#Format output depends of the value type
					if($PCoIPLog.($Vars[1]).($Vars[2])[0].GetType() -eq [Int]) {
						$Value = $Value.ToString("f0", $enUS)
					}

					if($PCoIPLog.($Vars[1]).($Vars[2])[0].GetType() -eq [Double]) {
						$Value = $Value.ToString("f2", $enUS)
					}
				}
			}
			
			$SearchString = '${' + $Prop + '}'
			$Template = Update-Template -SearchString $SearchString -Value $Value	
		}

		return $Template
	}
	
	#Define variables
	#Contains the HTML template string encoded in a BASE64 format
	$EncodedTemplate = "PAAhAEQATwBDAFQAWQBQAEUAIABoAHQAbQBsAD4APABoAHQAbQBsAD4ACQA8AGgAZQBhAGQAPgAJAAkAPABtAGUAdABhACAAYwBoAGEAcgBzAGUAdAA9ACIAVQBUAEYALQA4ACIAPgAJAAkAPAB0AGkAdABsAGUAPgBDAGgAYQByAHQAcwA8AC8AdABpAHQAbABlAD4ACQAJADwAbABpAG4AawAgAHIAZQBsAD0AIgBzAHQAeQBsAGUAcwBoAGUAZQB0ACIAIAB0AHkAcABlAD0AIgB0AGUAeAB0AC8AYwBzAHMAIgAgAGgAcgBlAGYAPQAiAGgAdAB0AHAAcwA6AC8ALwBjAGQAbgBqAHMALgBjAGwAbwB1AGQAZgBsAGEAcgBlAC4AYwBvAG0ALwBhAGoAYQB4AC8AbABpAGIAcwAvAHMAZQBtAGEAbgB0AGkAYwAtAHUAaQAvADIALgAyAC4AMQAzAC8AcwBlAG0AYQBuAHQAaQBjAC4AbQBpAG4ALgBjAHMAcwAiAD4ACQAJADwAcwBjAHIAaQBwAHQAIABzAHIAYwA9ACIAaAB0AHQAcABzADoALwAvAGMAbwBkAGUALgBqAHEAdQBlAHIAeQAuAGMAbwBtAC8AagBxAHUAZQByAHkALQAzAC4AMQAuADEALgBtAGkAbgAuAGoAcwAiAD4APAAvAHMAYwByAGkAcAB0AD4ACQAJADwAcwBjAHIAaQBwAHQAIABzAHIAYwA9ACIAaAB0AHQAcABzADoALwAvAGMAZABuAGoAcwAuAGMAbABvAHUAZABmAGwAYQByAGUALgBjAG8AbQAvAGEAagBhAHgALwBsAGkAYgBzAC8AcwBlAG0AYQBuAHQAaQBjAC0AdQBpAC8AMgAuADIALgAxADMALwBzAGUAbQBhAG4AdABpAGMALgBtAGkAbgAuAGoAcwAiAD4APAAvAHMAYwByAGkAcAB0AD4ACQAJADwAcwBjAHIAaQBwAHQAIABzAHIAYwA9ACIAaAB0AHQAcABzADoALwAvAGMAZABuAGoAcwAuAGMAbABvAHUAZABmAGwAYQByAGUALgBjAG8AbQAvAGEAagBhAHgALwBsAGkAYgBzAC8AQwBoAGEAcgB0AC4AagBzAC8AMgAuADcALgAxAC8AQwBoAGEAcgB0AC4AbQBpAG4ALgBqAHMAIgA+ADwALwBzAGMAcgBpAHAAdAA+AAkACQA8AC8AaABlAGEAZAA+AAkAPABiAG8AZAB5AD4ACQAJADwAIQAtAC0ARwBlAG4AZQByAGEAbAAgAGkAbgBmAG8AIABiAGwAbwBjAGsALQAtAD4ACQAJAAkAPABkAGkAdgAgAGMAbABhAHMAcwA9ACIAdQBpACAAbwBuAGUAIABjAG8AbAB1AG0AbgAgAHMAdABhAGMAawBhAGIAbABlACAAZwByAGkAZAAgAGMAZQBuAHQAZQByACAAYQBsAGkAZwBuAGUAZAAgAGMAbwBuAHQAYQBpAG4AZQByACAAcwBlAGcAbQBlAG4AdAAiAD4ACQAJAAkAPABkAGkAdgAgAGMAbABhAHMAcwA9ACIAYwBvAGwAdQBtAG4AIgA+AAkACQAJAAkAPABoADMAPgBHAGUAbgBlAHIAYQBsACAASQBuAGYAbwA8AC8AaAAzAD4ACQAJAAkACQA8AGQAaQB2ACAAYwBsAGEAcwBzAD0AIgB1AGkAIABsAGUAZgB0ACAAYQBsAGkAZwBuAGUAZAAgAGMAbwBuAHQAYQBpAG4AZQByACIAPgAJAAkACQAJAAkAPABwAD4ATABvAGcAIABmAGkAbABlADoAIAAkAHsATABvAGcARgBpAGwAZQB9ADwALwBwAD4ACQAJAAkACQAJADwAcAA+AFMAZQByAHYAZQByACAAbgBhAG0AZQA6ACAAJAB7AFMAZQByAHYAZQByAC4ATgBhAG0AZQB9ADwALwBwAD4ACQAJAAkACQAJADwAcAA+AFMAZQByAHYAZQByACAASQBQACAAYQBkAGQAcgBlAHMAcwA6ACAAJAB7AFMAZQByAHYAZQByAC4ASQBQAH0APAAvAHAAPgAJAAkACQAJAAkAPABwAD4AQwBsAGkAZQBuAHQAIABJAFAAIABhAGQAZAByAGUAcwBzADoAIAAkAHsAQwBsAGkAZQBuAHQALgBJAFAAfQA8AC8AcAA+AAkACQAJAAkACQA8AHAAPgBQAEMAbwBJAFAAIABzAG8AZgB0AHcAYQByAGUAIAB2AGUAcgBzAGkAbwBuADoAIAAkAHsAVgBlAHIAcwBpAG8AbgAuAEYAdQBsAGwAfQA8AC8AcAA+AAkACQAJAAkACQA8AHAAPgBFAG4AYwByAHkAcAB0AGkAbwBuACAAYQBsAGcAbwByAHkAdABoAG0AOgAgACQAewBFAG4AYwByAHkAcAB0AGkAbwBuAH0APAAvAHAAPgAJAAkACQAJAAkAPABwAD4AUwBlAHMAcwBpAG8AbgAgAHMAdABhAHIAdAAgAHQAaQBtAGUAOgAgACQAewBTAHQAYQByAHQAVABpAG0AZQB9ADwALwBwAD4ACQAJAAkACQAJADwAcAA+AFMAZQBzAHMAaQBvAG4AIABlAG4AZAAgAHQAaQBtAGUAOgAgACQAewBFAG4AZABUAGkAbQBlAH0APAAvAHAAPgAJAAkACQAJAAkAPABwAD4AUwBlAHMAcwBpAG8AbgAgAGQAdQByAGEAdABpAG8AbgA6ACAAJAB7AEQAdQByAGEAdABpAG8AbgB9ADwALwBwAD4ACQAJAAkACQA8AC8AZABpAHYAPgAJAAkACQA8AC8AZABpAHYAPgAJAAkAPAAvAGQAaQB2AD4ACQAJADwAIQAtAC0ATgBlAHQAdwBvAHIAawAgAGIAbABvAGMAawAtAC0APgAJAAkACQA8AGQAaQB2ACAAYwBsAGEAcwBzAD0AIgB1AGkAIAB0AHcAbwAgAGMAbwBsAHUAbQBuACAAcwB0AGEAYwBrAGEAYgBsAGUAIABnAHIAaQBkACAAYwBlAG4AdABlAHIAIABhAGwAaQBnAG4AZQBkACAAYwBvAG4AdABhAGkAbgBlAHIAIABzAGUAZwBtAGUAbgB0ACIAPgAJAAkACQA8AGQAaQB2ACAAYwBsAGEAcwBzAD0AIgBjAG8AbAB1AG0AbgAiAD4ACQAJAAkACQA8AGgANAA+AE4AZQB0AHcAbwByAGsAIABTAHQAYQB0AGkAcwB0AGkAYwBzADwALwBoADQAPgAJAAkACQAJADwAYwBhAG4AdgBhAHMAIABpAGQAPQAiAE4AZQB0AHcAbwByAGsAQwBoAGEAcgB0ACIAIAB3AGkAZAB0AGgAPQAiADYAMAAwACIAIABoAGUAaQBnAGgAdAA9ACIANgAwADAAIgA+ADwALwBjAGEAbgB2AGEAcwA+AAkACQAJAAkAPABkAGkAdgAgAGMAbABhAHMAcwA9ACIAdQBpACAAbABlAGYAdAAgAGEAbABpAGcAbgBlAGQAIABjAG8AbgB0AGEAaQBuAGUAcgAiAD4ACQAJAAkACQAJADwAcAA+AFIAWAAgAEEAdQBkAGkAbwAgACgAUABhAGMAawBlAHQAcwApADoAIAA8AHMAcABhAG4AIABpAGQAPQAiAFIAWABBAHUAZABpAG8AIgA+ACQAewBMAEEAUwBUAC4ATgBlAHQAUwB0AGEAdABzAC4AUgBYAEEAdQBkAGkAbwB9ADwALwBzAHAAYQBuAD4APAAvAHAAPgAJAAkACQAJAAkAPABwAD4AUgBYACAASQBtAGEAZwBlACAAKABQAGEAYwBrAGUAdABzACkAOgAgADwAcwBwAGEAbgAgAGkAZAA9ACIAUgBYAEkAbQBhAGcAZQAiAD4AJAB7AEwAQQBTAFQALgBOAGUAdABTAHQAYQB0AHMALgBSAFgASQBtAGEAZwBlAH0APAAvAHMAcABhAG4APgA8AC8AcAA+AAkACQAJAAkACQA8AHAAPgBSAFgAIABPAHQAaABlAHIAIAAoAFAAYQBjAGsAZQB0AHMAKQA6ACAAPABzAHAAYQBuACAAaQBkAD0AIgBSAFgATwB0AGgAZQByACIAPgAkAHsATABBAFMAVAAuAE4AZQB0AFMAdABhAHQAcwAuAFIAWABPAHQAaABlAHIAfQA8AC8AcwBwAGEAbgA+ADwALwBwAD4ACQAJAAkACQAJADwAcAA+AFQAbwB0AGEAbAAgAFIAWAAgACgAUABhAGMAawBlAHQAcwApADoAIAA8AHMAcABhAG4AIABpAGQAPQAiAFIAWABUAG8AdABhAGwAIgA+ADwALwBzAHAAYQBuAD4APAAvAHAAPgAJAAkACQAJAAkAPABwAD4AVABYACAAQQB1AGQAaQBvACAAKABQAGEAYwBrAGUAdABzACkAOgAgADwAcwBwAGEAbgAgAGkAZAA9ACIAVABYAEEAdQBkAGkAbwAiAD4AJAB7AEwAQQBTAFQALgBOAGUAdABTAHQAYQB0AHMALgBUAFgAQQB1AGQAaQBvAH0APAAvAHMAcABhAG4APgA8AC8AcAA+AAkACQAJAAkACQA8AHAAPgBUAFgAIABJAG0AYQBnAGUAIAAoAFAAYQBjAGsAZQB0AHMAKQA6ACAAPABzAHAAYQBuACAAaQBkAD0AIgBUAFgASQBtAGEAZwBlACIAPgAkAHsATABBAFMAVAAuAE4AZQB0AFMAdABhAHQAcwAuAFQAWABJAG0AYQBnAGUAfQA8AC8AcwBwAGEAbgA+ADwALwBwAD4ACQAJAAkACQAJADwAcAA+AFQAWAAgAE8AdABoAGUAcgAgACgAUABhAGMAawBlAHQAcwApADoAIAA8AHMAcABhAG4AIABpAGQAPQAiAFQAWABPAHQAaABlAHIAIgA+ACQAewBMAEEAUwBUAC4ATgBlAHQAUwB0AGEAdABzAC4AVABYAE8AdABoAGUAcgB9ADwALwBzAHAAYQBuAD4APAAvAHAAPgAJAAkACQAJAAkAPABwAD4AVABvAHQAYQBsACAAVABYACAAKABQAGEAYwBrAGUAdABzACkAOgAgADwAcwBwAGEAbgAgAGkAZAA9ACIAVABYAFQAbwB0AGEAbAAiAD4APAAvAHMAcABhAG4APgA8AC8AcAA+AAkACQAJAAkACQAJAAkACQA8AC8AZABpAHYAPgAJAAkACQAJADwALwBkAGkAdgA+AAkACQAJADwAZABpAHYAIABjAGwAYQBzAHMAPQAiAGMAbwBsAHUAbQBuACIAPgAJAAkACQAJADwAaAA0AD4AQgBhAG4AZAB3AGkAZAB0AGgAIABVAHMAYQBnAGUAPAAvAGgANAA+AAkACQAJAAkAPABjAGEAbgB2AGEAcwAgAGkAZAA9ACIAQgBhAG4AZAB3AGkAZAB0AGgAQwBoAGEAcgB0ACIAIAB3AGkAZAB0AGgAPQAiADYAMAAwACIAIABoAGUAaQBnAGgAdAA9ACIANgAwADAAIgA+ADwALwBjAGEAbgB2AGEAcwA+AAkACQAJAAkAPABkAGkAdgAgAGMAbABhAHMAcwA9ACIAdQBpACAAbABlAGYAdAAgAGEAbABpAGcAbgBlAGQAIABjAG8AbgB0AGEAaQBuAGUAcgAiAD4ACQAJAAkACQAJADwAcAA+AEEAdgBlAHIAYQBnAGUAIABSAFgAIAAoAEsAQgB5AHQAZQBzAC8AcwApADoAIAAkAHsAQQBWAEcALgBCAGQAdwB0AGgAUwB0AGEAdABzAC4AQQBWAEcAUgBYAH0APAAvAHAAPgAJAAkACQAJAAkAPABwAD4AQQB2AGUAcgBhAGcAZQAgAFQAWAAgACgASwBCAHkAdABlAHMALwBzACkAOgAgACQAewBBAFYARwAuAEIAZAB3AHQAaABTAHQAYQB0AHMALgBBAFYARwBUAFgAfQA8AC8AcAA+AAkACQAJAAkACQAJAAkAPAAvAGQAaQB2AD4ACQAJAAkACQAJAAkACQAJADwALwBkAGkAdgA+AAkACQA8AC8AZABpAHYAPgAJAAkAPAAhAC0ALQBOAGUAdAB3AG8AcgBrACAAcQB1AGEAbABpAHQAeQAgAGIAbABvAGMAawAtAC0APgAJAAkAPABkAGkAdgAgAGMAbABhAHMAcwA9ACIAdQBpACAAdAB3AG8AIABjAG8AbAB1AG0AbgAgAHMAdABhAGMAawBhAGIAbABlACAAZwByAGkAZAAgAGMAZQBuAHQAZQByACAAYQBsAGkAZwBuAGUAZAAgAGMAbwBuAHQAYQBpAG4AZQByACAAcwBlAGcAbQBlAG4AdAAiAD4ACQAJAAkAPABkAGkAdgAgAGMAbABhAHMAcwA9ACIAYwBvAGwAdQBtAG4AIgA+AAkACQAJAAkAPABoADQAPgBMAG8AcwBzADwALwBoADQAPgAJAAkACQAJADwAYwBhAG4AdgBhAHMAIABpAGQAPQAiAEwAbwBzAHMAQwBoAGEAcgB0ACIAIAB3AGkAZAB0AGgAPQAiADYAMAAwACIAIABoAGUAaQBnAGgAdAA9ACIANgAwADAAIgA+ADwALwBjAGEAbgB2AGEAcwA+AAkACQAJAAkAPABkAGkAdgAgAGMAbABhAHMAcwA9ACIAdQBpACAAbABlAGYAdAAgAGEAbABpAGcAbgBlAGQAIABjAG8AbgB0AGEAaQBuAGUAcgAiAD4ACQAJAAkACQAJADwAcAA+AE0AQQBYACAAUgBYACAATABvAHMAcwAgACgAJgAjADMANwA7ACkAOgAgACQAewBNAEEAWAAuAE4AZQB0AFMAdABhAHQAcwAuAFIAWABMAG8AcwBzAH0APAAvAHAAPgAJAAkACQAJAAkAPABwAD4AQQBWAEcAIABSAFgAIABMAG8AcwBzACAAKAAmACMAMwA3ADsAKQA6ACAAJAB7AEEAVgBHAC4ATgBlAHQAUwB0AGEAdABzAC4AUgBYAEwAbwBzAHMAfQA8AC8AcAA+AAkACQAJAAkACQAJAAkACQAJAAkAPABwAD4ATQBBAFgAIABUAFgAIABMAG8AcwBzACAAKAAmACMAMwA3ADsAKQA6ACAAJAB7AE0AQQBYAC4ATgBlAHQAUwB0AGEAdABzAC4AVABYAEwAbwBzAHMAfQA8AC8AcAA+AAkACQAJAAkACQA8AHAAPgBBAFYARwAgAFIAWAAgAEwAbwBzAHMAIAAoACYAIwAzADcAOwApADoAIAAkAHsAQQBWAEcALgBOAGUAdABTAHQAYQB0AHMALgBUAFgATABvAHMAcwB9ADwALwBwAD4ACQAJAAkACQAJAAkACQAJAAkAPAAvAGQAaQB2AD4ACQAJAAkACQAJAAkACQA8AC8AZABpAHYAPgAJAAkACQA8AGQAaQB2ACAAYwBsAGEAcwBzAD0AIgBjAG8AbAB1AG0AbgAiAD4ACQAJAAkACQA8AGgANAA+AEwAYQB0AGUAbgBjAHkAPAAvAGgANAA+AAkACQAJAAkAPABjAGEAbgB2AGEAcwAgAGkAZAA9ACIATABhAHQAZQBuAGMAeQBDAGgAYQByAHQAIgAgAHcAaQBkAHQAaAA9ACIANgAwADAAIgAgAGgAZQBpAGcAaAB0AD0AIgA2ADAAMAAiAD4APAAvAGMAYQBuAHYAYQBzAD4ACQAJAAkACQA8AGQAaQB2ACAAYwBsAGEAcwBzAD0AIgB1AGkAIABsAGUAZgB0ACAAYQBsAGkAZwBuAGUAZAAgAGMAbwBuAHQAYQBpAG4AZQByACIAPgAJAAkACQAJAAkAPABwAD4ATQBhAHgAaQBtAHUAbQAgAGwAYQB0AGUAbgBjAHkAIAAoAG0AcwApADoAIAAkAHsATQBBAFgALgBMAGEAdABTAHQAYQB0AHMALgBNAGEAeAB9ADwALwBwAD4ACQAJAAkACQAJADwAcAA+AEEAdgBlAHIAYQBnAGUAIABsAGEAdABlAG4AYwB5ACAAKABtAHMAKQA6ACAAJAB7AEEAVgBHAC4ATABhAHQAUwB0AGEAdABzAC4AUgBUAFQAfQA8AC8AcAA+AAkACQAJAAkAPAAvAGQAaQB2AD4ACQAJAAkAPAAvAGQAaQB2AD4ACQAJADwALwBkAGkAdgA+AAkACQA8ACEALQAtAEkAbQBhAGcAZQAgAHEAdQBhAGwAaQB0AHkAIABiAGwAbwBjAGsALQAtAD4ACQAJADwAZABpAHYAIABjAGwAYQBzAHMAPQAiAHUAaQAgAHQAdwBvACAAYwBvAGwAdQBtAG4AIABzAHQAYQBjAGsAYQBiAGwAZQAgAGcAcgBpAGQAIABjAGUAbgB0AGUAcgAgAGEAbABpAGcAbgBlAGQAIABjAG8AbgB0AGEAaQBuAGUAcgAgAHMAZQBnAG0AZQBuAHQAIgA+AAkACQAJADwAZABpAHYAIABjAGwAYQBzAHMAPQAiAGMAbwBsAHUAbQBuACIAPgAJAAkACQAJADwAaAA0AD4AUQB1AGEAbABpAHQAeQA8AC8AaAA0AD4ACQAJAAkACQA8AGMAYQBuAHYAYQBzACAAaQBkAD0AIgBRAHUAYQBsAGkAdAB5AEMAaABhAHIAdAAiACAAdwBpAGQAdABoAD0AIgA2ADAAMAAiACAAaABlAGkAZwBoAHQAPQAiADYAMAAwACIAPgA8AC8AYwBhAG4AdgBhAHMAPgAJAAkACQAJADwAZABpAHYAIABjAGwAYQBzAHMAPQAiAHUAaQAgAGwAZQBmAHQAIABhAGwAaQBnAG4AZQBkACAAYwBvAG4AdABhAGkAbgBlAHIAIgA+AAkACQAJAAkACQA8AHAAPgBNAGEAeABpAG0AdQBtACAAUQB1AGEAbABpAHQAeQAgACgAJgAjADMANwA7ACkAOgAgACQAewBNAEEAWAAuAFEAdQBhAGwAaQB0AHkAUwB0AGEAdABzAC4AUQB1AGEAbABpAHQAeQB9ADwALwBwAD4ACQAJAAkACQAJADwAcAA+AE0AaQBuAGkAbQB1AG0AIABRAHUAYQBsAGkAdAB5ACAAKAAmACMAMwA3ADsAKQA6ACAAJAB7AE0ASQBOAC4AUQB1AGEAbABpAHQAeQBTAHQAYQB0AHMALgBRAHUAYQBsAGkAdAB5AH0APAAvAHAAPgAJAAkACQAJADwALwBkAGkAdgA+AAkACQAJAAkACQAJAAkAPAAvAGQAaQB2AD4ACQAJAAkAPABkAGkAdgAgAGMAbABhAHMAcwA9ACIAYwBvAGwAdQBtAG4AIgA+AAkACQAJAAkAPABoADQAPgBGAFAAUwA8AC8AaAA0AD4ACQAJAAkACQA8AGMAYQBuAHYAYQBzACAAaQBkAD0AIgBGAFAAUwBDAGgAYQByAHQAIgAgAHcAaQBkAHQAaAA9ACIANgAwADAAIgAgAGgAZQBpAGcAaAB0AD0AIgA2ADAAMAAiAD4APAAvAGMAYQBuAHYAYQBzAD4ACQAJAAkACQA8AGQAaQB2ACAAYwBsAGEAcwBzAD0AIgB1AGkAIABsAGUAZgB0ACAAYQBsAGkAZwBuAGUAZAAgAGMAbwBuAHQAYQBpAG4AZQByACIAPgAJAAkACQAJAAkAPABwAD4ATQBhAHgAaQBtAHUAbQAgAEYAUABTADoAIAAkAHsATQBBAFgALgBRAHUAYQBsAGkAdAB5AFMAdABhAHQAcwAuAEYAUABTAH0APAAvAHAAPgAJAAkACQAJAAkAPABwAD4AQQB2AGUAcgBhAGcAZQAgAEYAUABTADoAIAAkAHsAQQBWAEcALgBRAHUAYQBsAGkAdAB5AFMAdABhAHQAcwAuAEYAUABTAH0APAAvAHAAPgAJAAkACQAJAAkAPABwAD4ATQBpAG4AaQBtAHUAbQAgAEYAUABTADoAIAAkAHsATQBJAE4ALgBRAHUAYQBsAGkAdAB5AFMAdABhAHQAcwAuAEYAUABTAH0APAAvAHAAPgAJAAkACQAJADwALwBkAGkAdgA+AAkACQAJADwALwBkAGkAdgA+AAkACQA8AC8AZABpAHYAPgAJAAkAPABzAGMAcgBpAHAAdAA+AAkACQAJAHYAYQByACAAUgBYAFQAbwB0AGEAbAAgAD0AIABOAHUAbQBiAGUAcgAoACQAKAAnACMAUgBYAEEAdQBkAGkAbwAnACkALgB0AGUAeAB0ACgAKQApACAAKwAgAE4AdQBtAGIAZQByACgAJAAoACcAIwBSAFgASQBtAGEAZwBlACcAKQAuAHQAZQB4AHQAKAApACkAIAArACAATgB1AG0AYgBlAHIAKAAkACgAJwAjAFIAWABPAHQAaABlAHIAJwApAC4AdABlAHgAdAAoACkAKQA7AAkACQAJACQAKAAnACMAUgBYAFQAbwB0AGEAbAAnACkALgB0AGUAeAB0ACgAUgBYAFQAbwB0AGEAbAApADsACQAJAAkAdgBhAHIAIABUAFgAVABvAHQAYQBsACAAPQAgAE4AdQBtAGIAZQByACgAJAAoACcAIwBUAFgAQQB1AGQAaQBvACcAKQAuAHQAZQB4AHQAKAApACkAIAArACAATgB1AG0AYgBlAHIAKAAkACgAJwAjAFQAWABJAG0AYQBnAGUAJwApAC4AdABlAHgAdAAoACkAKQAgACsAIABOAHUAbQBiAGUAcgAoACQAKAAnACMAVABYAE8AdABoAGUAcgAnACkALgB0AGUAeAB0ACgAKQApADsACQAJAAkAJAAoACcAIwBUAFgAVABvAHQAYQBsACcAKQAuAHQAZQB4AHQAKABUAFgAVABvAHQAYQBsACkAOwAJAAkACQB2AGEAcgAgAGMAdAB4ACAAPQAgAGQAbwBjAHUAbQBlAG4AdAAuAGcAZQB0AEUAbABlAG0AZQBuAHQAQgB5AEkAZAAoACIATgBlAHQAdwBvAHIAawBDAGgAYQByAHQAIgApAC4AZwBlAHQAQwBvAG4AdABlAHgAdAAoACcAMgBkACcAKQA7AAkACQAJAHYAYQByACAATgBlAHQAdwBvAHIAawBDAGgAYQByAHQAIAA9ACAAbgBlAHcAIABDAGgAYQByAHQAKABjAHQAeAAsACAAewAJAAkACQAJAHQAeQBwAGUAOgAgACcAbABpAG4AZQAnACwACQAJAAkACQBkAGEAdABhADoAIAB7AAkACQAJAAkACQBsAGEAYgBlAGwAcwA6ACAAWwAkAHsATgBlAHQAUwB0AGEAdABzAC4ARABhAHQAZQB9AF0ALAAJAAkACQAJAAkAZABhAHQAYQBzAGUAdABzADoAIABbAAkACQAJAAkACQB7AAkACQAJAAkACQAJAGwAYQBiAGUAbAA6ACAAJwBUAG8AdABhAGwAIABSAFgAIAAoAEEAdQBkAGkAbwApACwAIABQAGEAYwBrAGUAdABzACcALAAJAAkACQAJAAkACQBkAGEAdABhADoAIABbACQAewBOAGUAdABTAHQAYQB0AHMALgBSAFgAQQB1AGQAaQBvAH0AXQAsAAkACQAJAAkACQAJAGIAbwByAGQAZQByAFcAaQBkAHQAaAA6ACAAMQAsAAkACQAJAAkACQAJAGIAbwByAGQAZQByAEMAbwBsAG8AcgA6ACAAJwAjAEYARgAwADAAMAAwACcALAAJAAkACQAJAAkACQBiAGEAYwBrAGcAcgBvAHUAbgBkAEMAbwBsAG8AcgA6ACAAJwByAGcAYgBhACgAMAAsACAAMAAsACAAMAAsACAAMAAuADAAKQAnAAkACQAJAAkACQB9ACwACQAJAAkACQAJAHsACQAJAAkACQAJAAkAbABhAGIAZQBsADoAIAAnAFQAbwB0AGEAbAAgAFIAWAAgACgASQBtAGEAZwBlACkALAAgAFAAYQBjAGsAZQB0AHMAJwAsAAkACQAJAAkACQAJAGQAYQB0AGEAOgAgAFsAJAB7AE4AZQB0AFMAdABhAHQAcwAuAFIAWABJAG0AYQBnAGUAfQBdACwACQAJAAkACQAJAAkAYgBvAHIAZABlAHIAVwBpAGQAdABoADoAIAAxACwACQAJAAkACQAJAAkAYgBvAHIAZABlAHIAQwBvAGwAbwByADoAIAAnACMAQQBBADAAMAAwADAAJwAsAAkACQAJAAkACQAJAGIAYQBjAGsAZwByAG8AdQBuAGQAQwBvAGwAbwByADoAIAAnAHIAZwBiAGEAKAAwACwAIAAwACwAIAAwACwAIAAwAC4AMAApACcACQAJAAkACQAJAH0ALAAJAAkACQAJAAkAewAJAAkACQAJAAkACQBsAGEAYgBlAGwAOgAgACcAVABvAHQAYQBsACAAUgBYACAAKABPAHQAaABlAHIAKQAsACAAUABhAGMAawBlAHQAcwAnACwACQAJAAkACQAJAAkAZABhAHQAYQA6ACAAWwAkAHsATgBlAHQAUwB0AGEAdABzAC4AUgBYAE8AdABoAGUAcgB9AF0ALAAJAAkACQAJAAkACQBiAG8AcgBkAGUAcgBXAGkAZAB0AGgAOgAgADEALAAJAAkACQAJAAkACQBiAG8AcgBkAGUAcgBDAG8AbABvAHIAOgAgACcAIwA2ADYAMAAwADAAMAAnACwACQAJAAkACQAJAAkAYgBhAGMAawBnAHIAbwB1AG4AZABDAG8AbABvAHIAOgAgACcAcgBnAGIAYQAoADAALAAgADAALAAgADAALAAgADAALgAwACkAJwAJAAkACQAJAAkAfQAsAAkACQAJAAkACQB7AAkACQAJAAkACQAJAGwAYQBiAGUAbAA6ACAAJwBUAG8AdABhAGwAIABUAFgAIAAoAEEAdQBkAGkAbwApACwAIABQAGEAYwBrAGUAdABzACcALAAJAAkACQAJAAkACQBkAGEAdABhADoAIABbACQAewBOAGUAdABTAHQAYQB0AHMALgBUAFgAQQB1AGQAaQBvAH0AXQAsAAkACQAJAAkACQAJAGIAbwByAGQAZQByAFcAaQBkAHQAaAA6ACAAMQAsAAkACQAJAAkACQAJAGIAbwByAGQAZQByAEMAbwBsAG8AcgA6ACAAJwAjADAAMAAwADAARgBGACcALAAJAAkACQAJAAkACQBiAGEAYwBrAGcAcgBvAHUAbgBkAEMAbwBsAG8AcgA6ACAAJwByAGcAYgBhACgAMAAsACAAMAAsACAAMAAsACAAMAAuADAAKQAnAAkACQAJAAkACQB9ACwACQAJAAkACQAJAHsACQAJAAkACQAJAAkAbABhAGIAZQBsADoAIAAnAFQAbwB0AGEAbAAgAFQAWAAgACgASQBtAGEAZwBlACkALAAgAFAAYQBjAGsAZQB0AHMAJwAsAAkACQAJAAkACQAJAGQAYQB0AGEAOgAgAFsAJAB7AE4AZQB0AFMAdABhAHQAcwAuAFQAWABJAG0AYQBnAGUAfQBdACwACQAJAAkACQAJAAkAYgBvAHIAZABlAHIAVwBpAGQAdABoADoAIAAxACwACQAJAAkACQAJAAkAYgBvAHIAZABlAHIAQwBvAGwAbwByADoAIAAnACMAMAAwADAAMABBAEEAJwAsAAkACQAJAAkACQAJAGIAYQBjAGsAZwByAG8AdQBuAGQAQwBvAGwAbwByADoAIAAnAHIAZwBiAGEAKAAwACwAIAAwACwAIAAwACwAIAAwAC4AMAApACcACQAJAAkACQAJAH0ALAAJAAkACQAJAAkAewAJAAkACQAJAAkACQBsAGEAYgBlAGwAOgAgACcAVABvAHQAYQBsACAAVABYACAAKABPAHQAaABlAHIAKQAsACAAUABhAGMAawBlAHQAcwAnACwACQAJAAkACQAJAAkAZABhAHQAYQA6ACAAWwAkAHsATgBlAHQAUwB0AGEAdABzAC4AVABYAE8AdABoAGUAcgB9AF0ALAAJAAkACQAJAAkACQBiAG8AcgBkAGUAcgBXAGkAZAB0AGgAOgAgADEALAAJAAkACQAJAAkACQBiAG8AcgBkAGUAcgBDAG8AbABvAHIAOgAgACcAIwAwADAAMAAwADYANgAnACwACQAJAAkACQAJAAkAYgBhAGMAawBnAHIAbwB1AG4AZABDAG8AbABvAHIAOgAgACcAcgBnAGIAYQAoADAALAAgADAALAAgADAALAAgADAALgAwACkAJwAJAAkACQAJAAkAfQAJAAkACQAJAAkAXQAJAAkACQAJAH0ALAAJAAkACQAJAG8AcAB0AGkAbwBuAHMAOgAgAHsACQAJAAkACQBlAGwAZQBtAGUAbgB0AHMAOgAgAHsACQAJAAkACQAJAGwAaQBuAGUAOgAgAHsACQAJAAkACQAJAAkAdABlAG4AcwBpAG8AbgA6ACAAMAAJAAkACQAJAAkAfQAJAAkACQAJAH0ALAAJAAkACQAJAAkAcwBjAGEAbABlAHMAOgAgAHsACQAJAAkACQAJAAkAeQBBAHgAZQBzADoAIABbAHsACQAJAAkACQAJAAkACQB0AGkAYwBrAHMAOgAgAHsACQAJAAkACQAJAAkACQAJAGIAZQBnAGkAbgBBAHQAWgBlAHIAbwA6AHQAcgB1AGUACQAJAAkACQAJAAkACQB9AAkACQAJAAkACQAJAH0AXQAJAAkACQAJAAkAfQAJAAkACQAJAH0ACQAJAAkAfQApADsACQAJAAkACQAJAAkAdgBhAHIAIABjAHQAeAAgAD0AIABkAG8AYwB1AG0AZQBuAHQALgBnAGUAdABFAGwAZQBtAGUAbgB0AEIAeQBJAGQAKAAiAEIAYQBuAGQAdwBpAGQAdABoAEMAaABhAHIAdAAiACkALgBnAGUAdABDAG8AbgB0AGUAeAB0ACgAJwAyAGQAJwApADsACQAJAAkAdgBhAHIAIABCAGEAbgBkAHcAaQBkAHQAaABDAGgAYQByAHQAIAA9ACAAbgBlAHcAIABDAGgAYQByAHQAKABjAHQAeAAsACAAewAJAAkACQAJAHQAeQBwAGUAOgAgACcAbABpAG4AZQAnACwACQAJAAkACQBkAGEAdABhADoAIAB7AAkACQAJAAkACQBsAGEAYgBlAGwAcwA6ACAAWwAkAHsAQgBkAHcAdABoAFMAdABhAHQAcwAuAEQAYQB0AGUAfQBdACwACQAJAAkACQAJAGQAYQB0AGEAcwBlAHQAcwA6ACAAWwAJAAkACQAJAAkAewAJAAkACQAJAAkACQBsAGEAYgBlAGwAOgAgACcAQgBXACAATABpAG0AaQB0ACwAIABLAEIAeQB0AGUAcwAvAHMAJwAsAAkACQAJAAkACQAJAGQAYQB0AGEAOgAgAFsAJAB7AEIAZAB3AHQAaABTAHQAYQB0AHMALgBCAFcATABpAG0AaQB0AH0AXQAsAAkACQAJAAkACQAJAGIAbwByAGQAZQByAFcAaQBkAHQAaAA6ACAAMQAsAAkACQAJAAkACQAJAGIAbwByAGQAZQByAEMAbwBsAG8AcgA6ACAAJwAjADAAMABmAGYAMAAwACcALAAJAAkACQAJAAkACQBiAGEAYwBrAGcAcgBvAHUAbgBkAEMAbwBsAG8AcgA6ACAAJwByAGcAYgBhACgAMAAsACAAMAAsACAAMAAsACAAMAAuADAAKQAnAAkACQAJAAkACQB9ACwACQAJAAkACQAJAHsACQAJAAkACQAJAAkAbABhAGIAZQBsADoAIAAnAEEAdgBlAHIAYQBnAGUAIABSAFgALAAgAEsAQgB5AHQAZQBzAC8AcwAnACwACQAJAAkACQAJAAkAZABhAHQAYQA6ACAAWwAkAHsAQgBkAHcAdABoAFMAdABhAHQAcwAuAEEAVgBHAFIAWAB9AF0ALAAJAAkACQAJAAkACQBiAG8AcgBkAGUAcgBXAGkAZAB0AGgAOgAgADEALAAJAAkACQAJAAkACQBiAG8AcgBkAGUAcgBDAG8AbABvAHIAOgAgACcAIwBmAGYAMAAwADAAMAAnACwACQAJAAkACQAJAAkAYgBhAGMAawBnAHIAbwB1AG4AZABDAG8AbABvAHIAOgAgACcAcgBnAGIAYQAoADAALAAgADAALAAgADAALAAgADAALgAwACkAJwAJAAkACQAJAAkAfQAsAAkACQAJAAkACQB7AAkACQAJAAkACQAJAGwAYQBiAGUAbAA6ACAAJwBBAHYAZQByAGEAZwBlACAAVABYACwAIABLAEIAeQB0AGUAcwAvAHMAJwAsAAkACQAJAAkACQAJAGQAYQB0AGEAOgAgAFsAJAB7AEIAZAB3AHQAaABTAHQAYQB0AHMALgBBAFYARwBUAFgAfQBdACwACQAJAAkACQAJAAkAYgBvAHIAZABlAHIAVwBpAGQAdABoADoAIAAxACwACQAJAAkACQAJAAkAYgBvAHIAZABlAHIAQwBvAGwAbwByADoAIAAnACMAMAAwADAAMABmAGYAJwAsAAkACQAJAAkACQAJAGIAYQBjAGsAZwByAG8AdQBuAGQAQwBvAGwAbwByADoAIAAnAHIAZwBiAGEAKAAwACwAIAAwACwAIAAwACwAIAAwAC4AMAApACcACQAJAAkACQAJAH0ACQAJAAkACQAJAF0ACQAJAAkACQB9ACwACQAJAAkACQBvAHAAdABpAG8AbgBzADoAIAB7AAkACQAJAAkAZQBsAGUAbQBlAG4AdABzADoAIAB7AAkACQAJAAkACQBsAGkAbgBlADoAIAB7AAkACQAJAAkACQAJAHQAZQBuAHMAaQBvAG4AOgAgADAACQAJAAkACQAJAH0ACQAJAAkACQB9ACwACQAJAAkACQAJAHMAYwBhAGwAZQBzADoAIAB7AAkACQAJAAkACQAJAHkAQQB4AGUAcwA6ACAAWwB7AAkACQAJAAkACQAJAAkAdABpAGMAawBzADoAIAB7AAkACQAJAAkACQAJAAkACQBiAGUAZwBpAG4AQQB0AFoAZQByAG8AOgB0AHIAdQBlAAkACQAJAAkACQAJAAkAfQAJAAkACQAJAAkACQB9AF0ACQAJAAkACQAJAH0ACQAJAAkACQB9AAkACQAJAH0AKQA7AAkACQAJAAkACQB2AGEAcgAgAGMAdAB4ACAAPQAgAGQAbwBjAHUAbQBlAG4AdAAuAGcAZQB0AEUAbABlAG0AZQBuAHQAQgB5AEkAZAAoACIATABvAHMAcwBDAGgAYQByAHQAIgApAC4AZwBlAHQAQwBvAG4AdABlAHgAdAAoACcAMgBkACcAKQA7AAkACQAJAHYAYQByACAATABvAHMAcwBDAGgAYQByAHQAIAA9ACAAbgBlAHcAIABDAGgAYQByAHQAKABjAHQAeAAsACAAewAJAAkACQAJAHQAeQBwAGUAOgAgACcAbABpAG4AZQAnACwACQAJAAkACQBkAGEAdABhADoAIAB7AAkACQAJAAkACQBsAGEAYgBlAGwAcwA6ACAAWwAkAHsATgBlAHQAUwB0AGEAdABzAC4ARABhAHQAZQB9AF0ALAAJAAkACQAJAAkAZABhAHQAYQBzAGUAdABzADoAIABbAAkACQAJAAkACQB7AAkACQAJAAkACQAJAGwAYQBiAGUAbAA6ACAAJwBSAFgAIABMAG8AcwBzACwAIAAlACcALAAJAAkACQAJAAkACQBkAGEAdABhADoAIABbACQAewBOAGUAdABTAHQAYQB0AHMALgBSAFgATABvAHMAcwB9AF0ALAAJAAkACQAJAAkACQBiAG8AcgBkAGUAcgBXAGkAZAB0AGgAOgAgADEALAAJAAkACQAJAAkACQBiAG8AcgBkAGUAcgBDAG8AbABvAHIAOgAgACcAIwBBAEEAMAAwADAAMAAnACwACQAJAAkACQAJAAkAYgBhAGMAawBnAHIAbwB1AG4AZABDAG8AbABvAHIAOgAgACcAcgBnAGIAYQAoADAALAAgADAALAAgADAALAAgADAALgAwACkAJwAJAAkACQAJAAkAfQAsAAkACQAJAAkACQB7AAkACQAJAAkACQAJAGwAYQBiAGUAbAA6ACAAJwBUAFgAIABMAG8AcwBzACwAIAAlACcALAAJAAkACQAJAAkACQBkAGEAdABhADoAIABbACQAewBOAGUAdABTAHQAYQB0AHMALgBUAFgATABvAHMAcwB9AF0ALAAJAAkACQAJAAkACQBiAG8AcgBkAGUAcgBXAGkAZAB0AGgAOgAgADEALAAJAAkACQAJAAkACQBiAG8AcgBkAGUAcgBDAG8AbABvAHIAOgAgACcAIwAwADAAMAAwAEEAQQAnACwACQAJAAkACQAJAAkAYgBhAGMAawBnAHIAbwB1AG4AZABDAG8AbABvAHIAOgAgACcAcgBnAGIAYQAoADAALAAgADAALAAgADAALAAgADAALgAwACkAJwAJAAkACQAJAAkAfQAJAAkACQAJAAkAXQAJAAkACQAJAH0ALAAJAAkACQAJAG8AcAB0AGkAbwBuAHMAOgAgAHsACQAJAAkACQBlAGwAZQBtAGUAbgB0AHMAOgAgAHsACQAJAAkACQAJAGwAaQBuAGUAOgAgAHsACQAJAAkACQAJAAkAdABlAG4AcwBpAG8AbgA6ACAAMAAJAAkACQAJAAkAfQAJAAkACQAJAH0ALAAJAAkACQAJAAkAcwBjAGEAbABlAHMAOgAgAHsACQAJAAkACQAJAAkAeQBBAHgAZQBzADoAIABbAHsACQAJAAkACQAJAAkACQB0AGkAYwBrAHMAOgAgAHsACQAJAAkACQAJAAkACQAJAGIAZQBnAGkAbgBBAHQAWgBlAHIAbwA6AHQAcgB1AGUACQAJAAkACQAJAAkACQB9AAkACQAJAAkACQAJAH0AXQAJAAkACQAJAAkAfQAJAAkACQAJAH0ACQAJAAkAfQApADsACQAJAAkAdgBhAHIAIABjAHQAeAAgAD0AIABkAG8AYwB1AG0AZQBuAHQALgBnAGUAdABFAGwAZQBtAGUAbgB0AEIAeQBJAGQAKAAiAEwAYQB0AGUAbgBjAHkAQwBoAGEAcgB0ACIAKQAuAGcAZQB0AEMAbwBuAHQAZQB4AHQAKAAnADIAZAAnACkAOwAJAAkACQB2AGEAcgAgAEwAYQB0AGUAbgBjAHkAQwBoAGEAcgB0ACAAPQAgAG4AZQB3ACAAQwBoAGEAcgB0ACgAYwB0AHgALAAgAHsACQAJAAkACQB0AHkAcABlADoAIAAnAGwAaQBuAGUAJwAsAAkACQAJAAkAZABhAHQAYQA6ACAAewAJAAkACQAJAAkAbABhAGIAZQBsAHMAOgAgAFsAJAB7AEwAYQB0AFMAdABhAHQAcwAuAEQAYQB0AGUAfQBdACwACQAJAAkACQAJAGQAYQB0AGEAcwBlAHQAcwA6ACAAWwAJAAkACQAJAAkAewAJAAkACQAJAAkACQBsAGEAYgBlAGwAOgAgACcATQBhAHgAaQBtAHUAbQAgAGwAYQB0AGUAbgBjAHkALAAgAG0AcwAnACwACQAJAAkACQAJAAkAZABhAHQAYQA6ACAAWwAkAHsATABhAHQAUwB0AGEAdABzAC4ATQBhAHgAfQBdACwACQAJAAkACQAJAAkAYgBvAHIAZABlAHIAVwBpAGQAdABoADoAIAAxACwACQAJAAkACQAJAAkAYgBvAHIAZABlAHIAQwBvAGwAbwByADoAIAAnACMAQQBBADAAMABBAEEAJwAsAAkACQAJAAkACQAJAGIAYQBjAGsAZwByAG8AdQBuAGQAQwBvAGwAbwByADoAIAAnAHIAZwBiAGEAKAAwACwAIAAwACwAIAAwACwAIAAwAC4AMAApACcACQAJAAkACQAJAH0ALAAJAAkACQAJAAkAewAJAAkACQAJAAkACQBsAGEAYgBlAGwAOgAgACcAQQB2AGUAcgBhAGcAZQAgAGwAZQB0AGUAbgBjAHkALAAgAG0AcwAnACwACQAJAAkACQAJAAkAZABhAHQAYQA6ACAAWwAkAHsATABhAHQAUwB0AGEAdABzAC4AUgBUAFQAfQBdACwACQAJAAkACQAJAAkAYgBvAHIAZABlAHIAVwBpAGQAdABoADoAIAAxACwACQAJAAkACQAJAAkAYgBvAHIAZABlAHIAQwBvAGwAbwByADoAIAAnACMARgBGADAAMABGAEYAJwAsAAkACQAJAAkACQAJAGIAYQBjAGsAZwByAG8AdQBuAGQAQwBvAGwAbwByADoAIAAnAHIAZwBiAGEAKAAwACwAIAAwACwAIAAwACwAIAAwAC4AMAApACcACQAJAAkACQAJAH0ACQAJAAkACQAJAF0ACQAJAAkACQB9ACwACQAJAAkACQBvAHAAdABpAG8AbgBzADoAIAB7AAkACQAJAAkAZQBsAGUAbQBlAG4AdABzADoAIAB7AAkACQAJAAkACQBsAGkAbgBlADoAIAB7AAkACQAJAAkACQAJAHQAZQBuAHMAaQBvAG4AOgAgADAACQAJAAkACQAJAH0ACQAJAAkACQB9ACwACQAJAAkACQAJAHMAYwBhAGwAZQBzADoAIAB7AAkACQAJAAkACQAJAHkAQQB4AGUAcwA6ACAAWwB7AAkACQAJAAkACQAJAAkAdABpAGMAawBzADoAIAB7AAkACQAJAAkACQAJAAkACQBiAGUAZwBpAG4AQQB0AFoAZQByAG8AOgB0AHIAdQBlAAkACQAJAAkACQAJAAkAfQAJAAkACQAJAAkACQB9AF0ACQAJAAkACQAJAH0ACQAJAAkACQB9AAkACQAJAH0AKQA7AAkACQAJAHYAYQByACAAYwB0AHgAIAA9ACAAZABvAGMAdQBtAGUAbgB0AC4AZwBlAHQARQBsAGUAbQBlAG4AdABCAHkASQBkACgAIgBRAHUAYQBsAGkAdAB5AEMAaABhAHIAdAAiACkALgBnAGUAdABDAG8AbgB0AGUAeAB0ACgAJwAyAGQAJwApADsACQAJAAkAdgBhAHIAIABRAHUAYQBsAGkAdAB5AEMAaABhAHIAdAAgAD0AIABuAGUAdwAgAEMAaABhAHIAdAAoAGMAdAB4ACwAIAB7AAkACQAJAAkAdAB5AHAAZQA6ACAAJwBsAGkAbgBlACcALAAJAAkACQAJAGQAYQB0AGEAOgAgAHsACQAJAAkACQAJAGwAYQBiAGUAbABzADoAIABbACQAewBRAHUAYQBsAGkAdAB5AFMAdABhAHQAcwAuAEQAYQB0AGUAfQBdACwACQAJAAkACQAJAGQAYQB0AGEAcwBlAHQAcwA6ACAAWwAJAAkACQAJAAkAewAJAAkACQAJAAkACQBsAGEAYgBlAGwAOgAgACcAUQB1AGEAbABpAHQAeQAsACAAJQAnACwACQAJAAkACQAJAAkAZABhAHQAYQA6ACAAWwAkAHsAUQB1AGEAbABpAHQAeQBTAHQAYQB0AHMALgBRAHUAYQBsAGkAdAB5AH0AXQAsAAkACQAJAAkACQAJAGIAbwByAGQAZQByAFcAaQBkAHQAaAA6ACAAMQAsAAkACQAJAAkACQAJAGIAbwByAGQAZQByAEMAbwBsAG8AcgA6ACAAJwAjAEYARgA2ADYAMAAwACcALAAJAAkACQAJAAkACQBiAGEAYwBrAGcAcgBvAHUAbgBkAEMAbwBsAG8AcgA6ACAAJwByAGcAYgBhACgAMAAsACAAMAAsACAAMQA3ADAALAAgADAALgAwACkAJwAJAAkACQAJAAkAfQAJAAkACQAJAAkAXQAJAAkACQAJAH0ALAAJAAkACQAJAG8AcAB0AGkAbwBuAHMAOgAgAHsACQAJAAkACQBlAGwAZQBtAGUAbgB0AHMAOgAgAHsACQAJAAkACQAJAGwAaQBuAGUAOgAgAHsACQAJAAkACQAJAAkAdABlAG4AcwBpAG8AbgA6ACAAMAAJAAkACQAJAAkAfQAJAAkACQAJAH0ALAAJAAkACQAJAAkAcwBjAGEAbABlAHMAOgAgAHsACQAJAAkACQAJAAkAeQBBAHgAZQBzADoAIABbAHsACQAJAAkACQAJAAkACQB0AGkAYwBrAHMAOgAgAHsACQAJAAkACQAJAAkACQAJAHMAdQBnAGcAZQBzAHQAZQBkAE0AYQB4ADoAIAAxADAAMAAsAAkACQAJAAkACQAJAAkACQBiAGUAZwBpAG4AQQB0AFoAZQByAG8AOgB0AHIAdQBlAAkACQAJAAkACQAJAAkAfQAJAAkACQAJAAkACQB9AF0ACQAJAAkACQAJAH0ACQAJAAkACQB9AAkACQAJAH0AKQA7AAkACQAJAHYAYQByACAAYwB0AHgAIAA9ACAAZABvAGMAdQBtAGUAbgB0AC4AZwBlAHQARQBsAGUAbQBlAG4AdABCAHkASQBkACgAIgBGAFAAUwBDAGgAYQByAHQAIgApAC4AZwBlAHQAQwBvAG4AdABlAHgAdAAoACcAMgBkACcAKQA7AAkACQAJAHYAYQByACAARgBQAFMAQwBoAGEAcgB0ACAAPQAgAG4AZQB3ACAAQwBoAGEAcgB0ACgAYwB0AHgALAAgAHsACQAJAAkACQB0AHkAcABlADoAIAAnAGwAaQBuAGUAJwAsAAkACQAJAAkAZABhAHQAYQA6ACAAewAJAAkACQAJAAkAbABhAGIAZQBsAHMAOgAgAFsAJAB7AFEAdQBhAGwAaQB0AHkAUwB0AGEAdABzAC4ARABhAHQAZQB9AF0ALAAJAAkACQAJAAkAZABhAHQAYQBzAGUAdABzADoAIABbAAkACQAJAAkACQB7AAkACQAJAAkACQAJAGwAYQBiAGUAbAA6ACAAJwBGAFAAUwAnACwACQAJAAkACQAJAAkAZABhAHQAYQA6ACAAWwAkAHsAUQB1AGEAbABpAHQAeQBTAHQAYQB0AHMALgBGAFAAUwB9AF0ALAAJAAkACQAJAAkACQBiAG8AcgBkAGUAcgBXAGkAZAB0AGgAOgAgADEALAAJAAkACQAJAAkACQBiAG8AcgBkAGUAcgBDAG8AbABvAHIAOgAgACcAIwAwADAAYQBhADAAMAAnACwACQAJAAkACQAJAAkAYgBhAGMAawBnAHIAbwB1AG4AZABDAG8AbABvAHIAOgAgACcAcgBnAGIAYQAoADAALAAgADEANwAwACwAIAAwACwAIAAwAC4AMAApACcACQAJAAkACQAJAH0ACQAJAAkACQAJAF0ACQAJAAkACQB9ACwACQAJAAkACQBvAHAAdABpAG8AbgBzADoAIAB7AAkACQAJAAkAZQBsAGUAbQBlAG4AdABzADoAIAB7AAkACQAJAAkACQBsAGkAbgBlADoAIAB7AAkACQAJAAkACQAJAHQAZQBuAHMAaQBvAG4AOgAgADAACQAJAAkACQAJAH0ACQAJAAkACQB9ACwACQAJAAkACQAJAHMAYwBhAGwAZQBzADoAIAB7AAkACQAJAAkACQAJAHkAQQB4AGUAcwA6ACAAWwB7AAkACQAJAAkACQAJAAkAdABpAGMAawBzADoAIAB7AAkACQAJAAkACQAJAAkACQBiAGUAZwBpAG4AQQB0AFoAZQByAG8AOgB0AHIAdQBlAAkACQAJAAkACQAJAAkAfQAJAAkACQAJAAkACQB9AF0ACQAJAAkACQAJAH0ACQAJAAkACQB9AAkACQAJAH0AKQA7AAkACQA8AC8AcwBjAHIAaQBwAHQAPgAJAAkACQAJADwALwBiAG8AZAB5AD4APAAvAGgAdABtAGwAPgA="
	
	$Template = [System.Text.Encoding]::Unicode.GetString([System.Convert]::FromBase64String($EncodedTemplate))
	$enUS = New-Object System.Globalization.CultureInfo("en-US")
	
	if($Format -eq "TEXT") {
		$Result = Show-PCoIPStatistics -PCoIPLog $PCoIPLog -MaxSamples $MaxSamples		
	}
	
	if($Format -eq "CSV") {
		$Result = New-PCoIPCSVReport -PCoIPLog $PCoIPLog -MaxSamples $MaxSamples

	}

	if($Format -eq "HTML") {
		$Result = New-PCoIPHTMLReport -PCoIPLog $PCoIPLog -Template $Template -MaxSamples $MaxSamples
	}
	
	Write-Output $Result | Out-File -Encoding utf8 $ResultPath	
}

#Format and return values from PSObject
function global:Show-PCoIPStatistics {
	<#
		.SYNOPSIS
		This Cmdlet outputs information from the PCoIP log object to the screen

		.PARAMETER PCoIPLog
		Specifies the PCoIPLog object which contains information about PCoIP session.
		
		.PARAMETER MaxSamples
		Specifies the maximum number of rows in the output.		
		
		.EXAMPLE
		Show-PCoIPStatistics -PCoIPLog $PCoIPLog
		Description
		
		-----------
		
		This command outputs the information from the PCoIP log object to the screen		
		
		.LINK
		https://github.com/omnimod/PCoIPLogAnalyzer
	#>

	Param(
		[Parameter(Mandatory=$True,
		Position=0,
		HelpMessage="Please enter the PCoIP log object which contains session information")]
		[PsCustomObject] $PCoIPLog,
		
		[Parameter(
		HelpMessage="Please specify the maximum number of rows to output. If not defined, the default value is 1000")]
		[Int] $MaxSamples = 1000
	)

	function Resize-Array {
		param([Array] $Arr, [Int] $MaxSamples)
		
		$size = $Arr.Count
		
		if ($size -lt $MaxSamples) {
			return $Arr
		}
		
		$ResizeArray = @()
		
		for ($i = 0; $i -lt $size; $i += [math]::Ceiling($size/$MaxSamples)) {
			$ResizedArray = [Array]$ResizedArray + $Arr[$i]
		}	
		
		return $ResizedArray	
	}
	
	#Define variables
	$Result = @()
	
	$Result += "====================================General Info====================================="
	$Result += "Log file:               " + $PCoIPLog.LogFile
	$Result += "Server name:            " + $PCoIPLog.Server.Name
	$Result += "Server IP address:      " + $PCoIPLog.Server.IP
	$Result += "Client IP address:      " + $PCoIPLog.Client.IP
	$Result += "PCoIP software version: " + $PCoIPLog.Version.Full
	$Result += "Encryption algorythm:   " + $PCoIPLog.Encryption
	$Result += "Session start time:     " + $PCoIPLog.StartTime
	$Result += "Session end time:       " + $PCoIPLog.EndTime
	$Result += "Session duration:       " + $PCoIPLog.Duration.ToString()
	$Result += ""
	
	$Result += "=================================Network statistics=================================="
	
	$NetStats = Resize-Array -Arr $PCoIPLog.NetStats -MaxSamples $MaxSamples
	
	$Result += $NetStats | ft  Date,
	@{Label="RX Audio"; Expression={$_.RXAudio}},
	@{Label="RX Image"; Expression={$_.RXImage}},
	@{Label="RX Other"; Expression={$_.RXOther}},
	@{Label="RX Total"; Expression={$_.RXAudio + $_.RXImage + $_.RXOther}},
	@{Label="TX Audio"; Expression={$_.TXAudio}},
	@{Label="TX Image"; Expression={$_.TXImage}},
	@{Label="TX Other"; Expression={$_.TXOther}},
	@{Label="TX Total"; Expression={$_.TXAudio + $_.TXImage + $_.TXOther}} -AutoSize 4>&1
	
	$Result += "Total RX Audio: " + "{0:N2}" -f ($PCoIPLog.NetStats[$_.Count-1].RXAudio) + " Packets"
	$Result += "Total RX Image: " + "{0:N2}" -f ($PCoIPLog.NetStats[$_.Count-1].RXImage) + " Packets"
	$Result += "Total RX Other: " + "{0:N2}" -f ($PCoIPLog.NetStats[$_.Count-1].RXOther) + " Packets"
	$Result += "Total RX:       " + "{0:N2}" -f ($PCoIPLog.NetStats[$_.Count-1].RXAudio + $PCoIPLog.NetStats[$_.Count-1].RXImage + $PCoIPLog.NetStats[$_.Count-1].RXOther) + " Packets"
	$Result += ""

	$Result += "Total TX Audio: " + "{0:N2}" -f ($PCoIPLog.NetStats[$_.Count-1].TXAudio) + " Packets"
	$Result += "Total TX Image: " + "{0:N2}" -f ($PCoIPLog.NetStats[$_.Count-1].TXImage) + " Packets"
	$Result += "Total TX Other: " + "{0:N2}" -f ($PCoIPLog.NetStats[$_.Count-1].TXOther) + " Packets"
	$Result += "Total TX:       " + "{0:N2}" -f ($PCoIPLog.NetStats[$_.Count-1].TXAudio + $PCoIPLog.NetStats[$_.Count-1].TXImage + $PCoIPLog.NetStats[$_.Count-1].TXOther) + " Packets"
	$Result += ""	
	
	$Result += "================================Bandwidth statistics================================="
	
	$BdwthStatistics = Resize-Array -Arr $PCoIPLog.BdwthStats -MaxSamples $MaxSamples

	$Result += $BdwthStatistics | ft Date,
	@{Label="BW Limit, KB/s"; Expression={$_.BWLimit}},
	@{Label="AVG RX, KB/s"; Expression={$_.AVGRX}},
	@{Label="AVG TX, KB/s"; Expression={$_.AVGTX}} 4>&1

	$Result += "MAX BW limit: " + "{0:N2}" -f [System.Math]::Round(($PCoIPLog.BdwthStats.BWLimit | Measure-Object -Maximum).Maximum, 2) + " KBytes/s"
	$Result += "AVG BW limit: " + "{0:N2}" -f [System.Math]::Round(($PCoIPLog.BdwthStats.BWLimit | Measure-Object -Average).Average, 2) + " KBytes/s"
	$Result += "MIN BW limit: " + "{0:N2}" -f [System.Math]::Round(($PCoIPLog.BdwthStats.BWLimit | Measure-Object -Minimum).Minimum, 2) + " KBytes/s"
	$Result += ""
	$Result += "AVG RX:       " + "{0:N2}" -f [System.Math]::Round(($PCoIPLog.BdwthStats.AVGRX | Measure-Object -Average).Average, 2) + " KBytes/s"
	$Result += "AVG TX:       " + "{0:N2}" -f [System.Math]::Round(($PCoIPLog.BdwthStats.AVGTX | Measure-Object -Average).Average, 2) + " KBytes/s"
	$Result += ""
	
	$Result += "==================================Loss statistics===================================="

	$Result += $NetStats | ft Date,
	@{Label="RX Loss, %"; Expression={"{0:P2}" -f ($_.RXLoss/100)}},
	@{Label="TX Loss, %"; Expression={"{0:P2}" -f ($_.TXLoss/100)}} 4>&1
	
	$Result += "MAX RX Loss: " + "{0:P2}" -f (($PCoIPLog.NetStats.RXLoss | Measure-Object -Maximum).Maximum/100)
	$Result += "AVG RX Loss: " + "{0:P2}" -f ([System.Math]::Round(($PCoIPLog.NetStats.RXLoss | Measure-Object -Average).Average, 2)/100)
	$Result += ""
	$Result += "MAX TX Loss: " + "{0:P2}" -f (($PCoIPLog.NetStats.TXLoss | Measure-Object -Maximum).Maximum/100)
	$Result += "AVG TX Loss: " + "{0:P2}" -f ([System.Math]::Round(($PCoIPLog.NetStats.TXLoss | Measure-Object -Average).Average, 2)/100)
	$Result += ""	
	
	$Result += "=================================Latency statistics=================================="	
	
	$LatStats = Resize-Array -Arr $PCoIPLog.LatStats -MaxSamples $MaxSamples

	$Result += $LatStats | ft Date,
	@{Label="AVG Latency, ms"; Expression={$_.RTT}},
	@{Label="MAX Latency, ms"; Expression={$_.Max}} 4>&1
	
	$Result += "MAX Latency: " + "{0:N0}" -f ($PCoIPLog.LatStats.Max | Measure-Object -Maximum).Maximum + " ms"
	$Result += "AVG Latency: " + "{0:N0}" -f [System.Math]::Round(($PCoIPLog.LatStats.RTT | Measure-Object -Average).Average, 2) + " ms"
	$Result += ""

	$Result += "=================================Quality statistics=================================="
	
	$QualityStats = Resize-Array -Arr $PCoIPLog.QualityStats -MaxSamples $MaxSamples

	$Result += $QualityStats | ft Date,
	@{Label="TBL";Expression={"{0:N0}" -f ($_.TBL)}},
	@{Label="FPS";Expression={"{0:N2}" -f ($_.FPS)}},
	@{Label="Quality, %";Expression={"{0:P0}" -f ($_.Quality/100)}} 4>&1

	$Result += "MAX TBL: " + "{0:N0}" -f (($PCoIPLog.QualityStats.TBL | Measure-Object -Maximum).Maximum)
	$Result += "MIN TBL: " + "{0:N0}" -f (($PCoIPLog.QualityStats.TBL | Measure-Object -Minimum).Minimum)
	$Result += ""		
	
	$Result += "MAX FPS: " + "{0:N2}" -f (($PCoIPLog.QualityStats.FPS | Measure-Object -Maximum).Maximum)
	$Result += "AVG FPS: " + "{0:N2}" -f (($PCoIPLog.QualityStats.FPS | Measure-Object -Average).Average)
	$Result += "MIN FPS: " + "{0:N2}" -f (($PCoIPLog.QualityStats.FPS | Measure-Object -Minimum).Minimum)
	$Result += ""
	
	$Result += "MAX Quality: " + "{0:P0}" -f (($PCoIPLog.QualityStats.Quality | Measure-Object -Maximum).Maximum/100)
	$Result += "MIN Quality: " + "{0:P0}" -f (($PCoIPLog.QualityStats.Quality | Measure-Object -Minimum).Minimum/100)
	$Result += ""
	
	$Result += "================================Encoding statistics=================================="

	$EncodStats = Resize-Array -Arr $PCoIPLog.EncodStats -MaxSamples $MaxSamples
	
	$Result += $EncodStats | ft Date,
	@{Label="Bits per pixel";Expression={"{0:N2}" -f ($_.BitsPixel)}},
	@{Label="Bits per second";Expression={"{0:N0}" -f ($_.BitsSec)}},
	@{Label="Megapixels per second";Expression={"{0:N2}" -f ($_.MPixSec)}} 4>&1	
	
	$Result += "MAX Bits per pixel:        " + "{0:N2}" -f (($PCoIPLog.EncodStats.BitsPixel | Measure-Object -Maximum).Maximum)
	$Result += "AVG Bits per pixel:        " + "{0:N2}" -f (($PCoIPLog.EncodStats.BitsPixel | Measure-Object -Average).Average)
	$Result += "MIN Bits per pixel:        " + "{0:N2}" -f (($PCoIPLog.EncodStats.BitsPixel | Measure-Object -Minimum).Minimum)
	$Result += ""	
	
	$Result += "MAX Bits per second:       " + "{0:N0}" -f (($PCoIPLog.EncodStats.BitsSec | Measure-Object -Maximum).Maximum)
	$Result += "AVG Bits per second:       " + "{0:N0}" -f (($PCoIPLog.EncodStats.BitsSec | Measure-Object -Average).Average)
	$Result += "MIN Bits per second:       " + "{0:N0}" -f (($PCoIPLog.EncodStats.BitsSec | Measure-Object -Minimum).Minimum)
	$Result += ""
	
	$Result += "MAX Megapixels per second: " + "{0:N2}" -f (($PCoIPLog.EncodStats.MPixSec | Measure-Object -Maximum).Maximum)
	$Result += "AVG Megapixels per second: " + "{0:N2}" -f (($PCoIPLog.EncodStats.MPixSec | Measure-Object -Average).Average)
	$Result += "MIN Megapixels per second: " + "{0:N2}" -f (($PCoIPLog.EncodStats.MPixSec | Measure-Object -Minimum).Minimum)
	$Result += ""
	
	$Result += "================================Advanced statistics=================================="

	$AdvStats = Resize-Array -Arr $PCoIPLog.AdvStats -MaxSamples $MaxSamples

	$Result += $AdvStats | ft Date,
	@{Label="Cur_s";Expression={"{0:N0}" -f ($_.Cur_s)}},
	@{Label="Max_s";Expression={"{0:N0}" -f ($_.Max_s)}},
	@{Label="BWC";Expression={"{0:N2}" -f ($_.BWC)}},
	@{Label="BWT";Expression={"{0:N2}" -f ($_.BWT)}},
	@{Label="Changed FPS";Expression={"{0:N2}" -f ($_.ChangedFPS)}},
	@{Label="Decode Rate, MBit/s";Expression={"{0:N2}" -f ($_.DecodeRate)}} 4>&1	
	
	return $Result
}

#Retrieve data from pcoip_server log file and display it on the screen and/or export to the log file
function global:Get-PCoIPStatistics {
	<#
		.SYNOPSIS
		This Cmdlet parses the PCoIP log file and exports information to a file or outputs it to the screen

		.PARAMETER FilePath
		Specifies the path to the pcoip_server log file.

		.PARAMETER ResultPath
		Specifies the path to the file where results will be saved.
		
		.PARAMETER Format
		Specifies the format of the result file.
		
		.PARAMETER MaxSamples
		Specifies the maximum number of rows in the output.
		
		.PARAMETER NoScreenOutput
		Specifies to skip output the result to the screen.
		
		.EXAMPLE
		Get-PCoIPStatistics -FilePath "C:\Logs\pcoip_server_2014_07_24_00000b8c.txt" -ResultPath "C:\Results\report.txt"
		Description
		
		-----------
		
		This command gets information about the PCoIP session from the PCoIP log file, exports it to a text file and outputs to the screen.

		.EXAMPLE
		Get-PCoIPStatistics -FilePath "C:\Logs\pcoip_server_2014_07_24_00000b8c.txt" -ResultPath "C:\Results\report.txt" -Format HTML
		Description
		
		-----------
		
		This command gets information about the PCoIP session from the PCoIP log file, exports it to a html file and outputs to the screen.
		
		.LINK
		https://github.com/omnimod/PCoIPLogAnalyzer
	#>
	
	[CmdletBinding(
		DefaultParameterSetName="FilePath"
	)]

	Param(
		[Parameter(Mandatory=$True,
		Position=0,
		HelpMessage="Please enter the path to the pcoip_server log file")]
		[String] $FilePath,
		
		[Parameter(Position=1,
		HelpMessage="Please enter the path where the result file will be saved")]	
		[String] $ResultPath,

		[Parameter(
		HelpMessage="Please specify the format of the result file. Could be TEXT, HTML or CSV")]		
		[ValidateSet("CSV", "HTML", "TEXT")]
		[String]$Format = "TEXT",
	
		[Parameter(
		HelpMessage="Please specify the maximum number of rows to output. If not defined, the default value is 1000")]
		[Int] $MaxSamples = 1000,
		
		[switch] $NoScreenOutput
	)
	
	$PCoIPLog = Import-PCoIPLog -FilePath $FilePath
	
	if($ResultPath) {
		Export-PCoIPStatistics -PCoIPLog $PCoIPLog -ResultPath $ResultPath -Format $Format -MaxSamples $MaxSamples
	}
	
	if(!$NoScreenOutput) {
		Show-PCoIPStatistics -PCoIPLog $PCoIPLog -MaxSamples $MaxSamples	
	}
}
